summary(is.na(df))
# Chunk 40
dim(df)
length(unique(df$customerID))
# Chunk 41
ll <- which(is.na(df$TotalCharges))
df[ll,"TotalCharges"] <- 0
summary(is.na(df$TotalCharges))
# Chunk 42
contingency_table<-table(df$MultipleLines,df$PhoneService)
sqrt(chisq.test(contingency_table)$statistic / (sum(contingency_table) * (min(dim(contingency_table)) - 1)))
# Chunk 43
res.cat=catdes(df, 21)
res.cat$test.chi2
head(res.cat$category)
res.cat$quanti.var
res.cat$quanti
# Chunk 44
df$OnlineSecurity[df$OnlineSecurity=="No internet service"] <- "No"
df$OnlineBackup[df$OnlineBackup=="No internet service"] <- "No"
df$DeviceProtection[df$DeviceProtection=="No internet service"] <- "No"
df$TechSupport[df$TechSupport=="No internet service"] <- "No"
df$StreamingTV[df$StreamingTV=="No internet service"] <- "No"
df$StreamingMovies[df$StreamingMovies=="No internet service"] <- "No"
# Chunk 45
df$MultipleLines[df$MultipleLines=="No phone service"] <- "No"
# Chunk 46
set.seed(1234)
m <- floor(0.7*nrow(df))
train_d <- sample(seq_len(nrow(df)),size = m)
train <- df[train_d,]
test <- df[-train_d,]
# Chunk 47
mod0 <- glm(Churn ~ 1, data=train, family=binomial)
mod0$deviance
# Chunk 48
which(sapply(df, is.numeric))
# Chunk 49
mod1 <- glm(Churn ~ tenure, data=train, family=binomial)
mod1$deviance;AIC(mod0,mod1) #summary(mod1)
anova( mod0, mod1,  test="Chisq")
# Chunk 50
mod2 <- glm(Churn ~ tenure + MonthlyCharges, data=train, family=binomial)
mod2$deviance
AIC(mod2) #4473.45
anova( mod1, mod2,  test="Chisq")
residualPlot(mod2)
mod3 <- glm(Churn ~ tenure + MonthlyCharges + TotalCharges, data=train, family=binomial)
mod3$deviance
anova( mod2, mod3,  test="Chisq") #significant
AIC(mod3) #4468.55
treshold_vif<-function(rsq){
vif<- 1/(1-rsq)
return(vif)
}
treshold_vif(summary(mod3)$r.squared)
vif(mod3)
treshold_vif<-function(rsq){
vif<- 1/(1-rsq)
return(vif)
}
treshold_vif(summary(mod3)$r.squared)
summary(mod3)$r.squared
mod3
vif(mod3)
rmse <- function(fitted, actual){
sqrt(mean((fitted - actual)^2))
}
RSQUARE <- function(predictions, actual_values) {
ss_residual <- sum((actual_values - predictions)^2)
ss_total <- sum((actual_values - mean(actual_values))^2)
rsquare <- 1 - (ss_residual / ss_total)
return(rsquare)
}
results <- data.frame(Model = c("Model with train_new sample",
"Model with test_new sample"),
RSQRT = round(c(RSQUARE(exp(fitted(v1)), train$churn),
RSQUARE(exp(predict(v1, newdata = test)), test$churn)),2),
RMSE = round(c(rmse(exp(fitted(v1)), train$churn),
rmse(exp(predict(v1, newdata = test)), test$churn)),2))
results <- data.frame(Model = c("Model with train_new sample",
"Model with test_new sample"),
RSQRT = round(c(RSQUARE(exp(fitted(mod23.4)), train$churn),
RSQUARE(exp(predict(mod23.4, newdata = test)), test$churn)),2),
RMSE = round(c(rmse(exp(fitted(mod23.4)), train$churn),
rmse(exp(predict(mod23.4, newdata = test)), test$churn)),2))
# Chunk 1
library(skimr)
library(car)
install.packages(c("bslib", "checkmate", "cpp11", "crosstalk", "dbplyr", "DEoptimR", "DescTools", "dplyr", "DT", "emmeans", "evaluate", "expm", "FactoMineR", "fansi", "foreign", "GGally", "ggplot2", "ggrepel", "haven", "htmlTable", "htmltools", "htmlwidgets", "httpuv", "insight", "knitr", "lava", "lifecycle", "lme4", "markdown", "Matrix", "MatrixModels", "mclust", "missMDA", "mvtnorm", "nlme", "ordinal", "pkgload", "plotrix", "pls", "polspline", "prettyunits", "pROC", "RcppEigen", "rlang", "robustbase", "rprojroot", "scales", "stringi", "stringr", "testthat", "tinytex", "utf8", "vctrs", "vroom", "waldo", "withr", "xfun"))
library(FactoMineR)
library(dplyr)
library(caret)
library(gridExtra)
library(pROC)
# Chunk 2
setwd("/Users/ali/Documents/GitHub/projSIM")
#setwd("C:/Users/Brunil/Desktop/Bruna/Master/SIM/assignment_2")
df<-read.csv("customer.xls", sep=",")
# Chunk 3
dim(df)
names(df)
#str(df)
#summary(df)
# Chunk 4
sum(is.na(df$gender))
table(df$gender)
# Chunk 5
sum(is.na(df$SeniorCitizen))
table(df$SeniorCitizen)
# Chunk 6
sum(is.na(df$Partner))
table(df$Partner)
# Chunk 7
sum(is.na(df$Dependents))
table(df$Dependents)
# Chunk 8
#plots
par(mfrow = c(2, 2))
barplot(table(df$gender), main = "Distribution of gender",xlab = "Gender",col = "skyblue")
barplot(table(df$SeniorCitizen), main = "Distribution of SeniorCitizen",xlab = "SeniorCitizen",col = "skyblue")
barplot(table(df$Partner), main = "Distribution of Partner",xlab = "Partner",col = "skyblue")
barplot(table(df$Dependents), main = "Distribution of Dependents",xlab = "Dependents",col = "skyblue")
# Chunk 9
summary(df$tenure)
par(mfrow = c(1, 2))
hist(df$tenure,breaks=20, col="skyblue")
Boxplot(df$tenure, main="Outlier analysis for Tenure")
par(mfrow = c(1, 1))
sm_t <- summary(df$tenure)
iqr_t <- sm_t["3rd Qu."] - sm_t["1st Qu."]
# Mild Outliers
mild_ub_t <- sm_t["3rd Qu."] + 1.5 * iqr_t
mild_lb_t <- sm_t["1st Qu."] - 1.5 * iqr_t
length(which(df$tenure > mild_ub_t | df$tenure < mild_lb_t)) # number of mild outliers
# Severe Outliers
severe_ub_t <- sm_t["3rd Qu."] + 3 * iqr_t
severe_lb_t <- sm_t["1st Qu."] - 3 * iqr_t
length(which(df$tenure > severe_ub_t | df$tenure < severe_lb_t)) # number of severe outliers
# Chunk 10
sum(is.na(df$PhoneService))
table(df$PhoneService)
# Chunk 11
sum(is.na(df$MultipleLines))
table(df$MultipleLines)
# Chunk 12
subset(df, MultipleLines == "Yes" & PhoneService == "No")
# Chunk 13
table(df$InternetService)
# Chunk 14
table(df$OnlineSecurity)
# Chunk 15
#plots:
par(mfrow = c(2, 2))
barplot(table(df$PhoneService), main = "Distribution of PhoneService",xlab = "PhoneService",col = "skyblue") #unbalanced
barplot(table(df$MultipleLines), main = "Distribution of MultipleLines",xlab = "MultipleLines",col = "skyblue") #unbalanced
barplot(table(df$InternetService), main = "Distribution of InternetService",xlab = "InternetService",col = "skyblue")
barplot(table(df$OnlineSecurity), main = "Distribution of OnlineSecurity",xlab = "OnlineSecurity",col = "skyblue")
# Chunk 16
sum(df$InternetService == "No")
sum(df$OnlineSecurity == "No internet service")
nrow(subset(df, InternetService == "No" & OnlineSecurity == "No internet service"))
# Chunk 17
table(df$OnlineBackup)
# Chunk 18
# Check concistency
sum(df$OnlineBackup == "No internet service") #1526
sum(df$OnlineSecurity == "No internet service") #1526
# Chunk 19
table(df$DeviceProtection)
# Chunk 20
# Check concistency
sum(df$OnlineSecurity == "No internet service") #1526
sum(df$DeviceProtection == "No internet service") #1526
# Chunk 21
table(df$TechSupport)
# Chunk 22
#Check consistency
sum(df$DeviceProtection == "No internet service") #1526
sum(df$TechSupport == "No internet service") #1526
# Chunk 23
table(df$StreamingTV)
# Chunk 24
#Check consistency
sum(df$TechSupport == "No internet service") #1526
sum(df$StreamingTV == "No internet service") #1526
# Chunk 25
table(df$StreamingMovies)
# Chunk 26
#Check consistency
sum(df$StreamingTV == "No internet service") #1526
sum(df$StreamingMovies == "No internet service") #1526
# Chunk 27
#plots:
par(mfrow = c(2, 2))
barplot(table(df$OnlineBackup), main = "Distribution of OnlineBackup",xlab = "OnlineBackup",col = "skyblue")
barplot(table(df$DeviceProtection), main = "Distribution of DeviceProtection",xlab = "DeviceProtection",col = "skyblue")
barplot(table(df$TechSupport), main = "Distribution of TechSupport",xlab = "TechSupport",col = "skyblue")
barplot(table(df$StreamingTV), main = "Distribution of StreamingTV",xlab = "StreamingTV",col = "skyblue")
barplot(table(df$StreamingMovies), main = "Distribution of StreamingMovies",xlab = "StreamingMovies",col = "skyblue")
# Chunk 28
table(df$Contract)
# Chunk 29
table(df$PaperlessBilling)
# Chunk 30
table(df$PaymentMethod)
# Chunk 31
#plots
par(mfrow = c(2, 2))
barplot(table(df$Contract), main = "Distribution of Contract",xlab = "Contract",col = "skyblue")
barplot(table(df$PaperlessBilling), main = "Distribution of PaperlessBilling",xlab = "PaperlessBilling",col = "skyblue")
barplot(table(df$PaymentMethod), main = "Distribution of PaymentMethod",xlab = "PaymentMethod",col = "skyblue")
# Chunk 32
summary(df$MonthlyCharges)
par(mfrow = c(1,2 ))
hist(df$MonthlyCharges,breaks=20,col="skyblue")
Boxplot(df$MonthlyCharges, main="Outlier analysis for MonthlyCharges")
# Chunk 33
sm <- summary(df$MonthlyCharges)
iqr <- sm["3rd Qu."] - sm["1st Qu."]
# Mild Outliers
mild_ub <- sm["3rd Qu."] + 1.5 * iqr
mild_lb <- sm["1st Qu."] - 1.5 * iqr
length(which(df$MonthlyCharges > mild_ub | df$MonthlyCharges < mild_lb)) # number of mild outliers
# Severe Outliers
severe_ub <- sm["3rd Qu."] + 3 * iqr
severe_lb <- sm["1st Qu."] - 3 * iqr
length(which(df$MonthlyCharges > severe_ub | df$MonthlyCharges < severe_lb)) # number of severe outliers
# Chunk 34
summary(df$TotalCharges)
sum(is.na(df$TotalCharges))
par(mfrow = c(1, 2))
hist(df$TotalCharges,breaks=20,col="skyblue")
Boxplot(df$TotalCharges, main="Outlier analysis for TotalCharges")
# Chunk 35
sm <- summary(df$TotalCharges)
iqr <- sm["3rd Qu."] - sm["1st Qu."]
# Mild Outliers
mild_ub <- sm["3rd Qu."] + 1.5 * iqr
mild_lb <- sm["1st Qu."] - 1.5 * iqr
length(which(df$TotalCharges > mild_ub | df$TotalCharges < mild_lb)) # number of mild outliers
# Severe Outliers
severe_ub <- sm["3rd Qu."] + 3 * iqr
severe_lb <- sm["1st Qu."] - 3 * iqr
length(which(df$TotalCharges > severe_ub | df$TotalCharges < severe_lb)) # number of severe outliers
# Chunk 36
table(df$Churn)
prop.table(table(df$Churn))
barplot(table(df$Churn), col="skyblue")
# Chunk 37
char_cols <- which(sapply(df, is.character))
df[, char_cols[-1]]<- lapply(df[, char_cols[-1]], as.factor)
# Chunk 38
df$SeniorCitizen<- factor(df$SeniorCitizen)
# Chunk 39
summary(is.na(df))
# Chunk 40
dim(df)
length(unique(df$customerID))
# Chunk 41
ll <- which(is.na(df$TotalCharges))
df[ll,"TotalCharges"] <- 0
summary(is.na(df$TotalCharges))
# Chunk 42
contingency_table<-table(df$MultipleLines,df$PhoneService)
sqrt(chisq.test(contingency_table)$statistic / (sum(contingency_table) * (min(dim(contingency_table)) - 1)))
# Chunk 43
res.cat=catdes(df, 21)
res.cat$test.chi2
head(res.cat$category)
res.cat$quanti.var
res.cat$quanti
# Chunk 44
df$OnlineSecurity[df$OnlineSecurity=="No internet service"] <- "No"
df$OnlineBackup[df$OnlineBackup=="No internet service"] <- "No"
df$DeviceProtection[df$DeviceProtection=="No internet service"] <- "No"
df$TechSupport[df$TechSupport=="No internet service"] <- "No"
df$StreamingTV[df$StreamingTV=="No internet service"] <- "No"
df$StreamingMovies[df$StreamingMovies=="No internet service"] <- "No"
# Chunk 45
df$MultipleLines[df$MultipleLines=="No phone service"] <- "No"
# Chunk 46
set.seed(1234)
m <- floor(0.7*nrow(df))
train_d <- sample(seq_len(nrow(df)),size = m)
train <- df[train_d,]
test <- df[-train_d,]
# Chunk 47
mod0 <- glm(Churn ~ 1, data=train, family=binomial)
mod0$deviance
# Chunk 48
which(sapply(df, is.numeric))
# Chunk 49
mod1 <- glm(Churn ~ tenure, data=train, family=binomial)
mod1$deviance;AIC(mod0,mod1) #summary(mod1)
anova( mod0, mod1,  test="Chisq")
# Chunk 50
mod2 <- glm(Churn ~ tenure + MonthlyCharges, data=train, family=binomial)
mod2$deviance
AIC(mod2) #4473.45
anova( mod1, mod2,  test="Chisq")
residualPlot(mod2)
# Chunk 51
mod3 <- glm(Churn ~ tenure + MonthlyCharges + TotalCharges, data=train, family=binomial)
mod3$deviance
anova( mod2, mod3,  test="Chisq") #significant
AIC(mod3) #4468.55
vif(mod3)
residualPlot(mod3)
# Chunk 52
infl <- influence.measures(mod3)
sum(residuals(mod3,'deviance')^2)
sum(residuals(mod3,'pearson')^2)
influential_indices <- which(infl$is.inf == TRUE)
length(influential_indices)
length(train$customerID)
# Chunk 53
residualPlot(mod3)
# Chunk 54
mod4 <- glm(Churn ~ tenure + MonthlyCharges + Contract, data=train, family=binomial)
AIC(mod4) #4302.2 better
anova( mod3, mod4,  test="Chisq") #significant
vif(mod4)
residualPlot(mod4)
# Chunk 55
mod5 <- glm(Churn ~ tenure + MonthlyCharges + Contract + InternetService, data=train, family=binomial)
AIC(mod5) #4254.1 better
anova( mod4, mod5,  test="Chisq") #significant
vif(mod5)
residualPlot(mod5)
# Chunk 56
mod6 <- glm(Churn ~ tenure + MonthlyCharges + Contract + InternetService + StreamingMovies, data=train, family=binomial)
AIC(mod6) #4238.6 better
anova( mod5, mod6,  test="Chisq") #significant
vif(mod6)
residualPlot(mod6)
# Chunk 57
mod7 <- glm(Churn ~ tenure + MonthlyCharges + Contract + InternetService + StreamingMovies + StreamingTV, data=train, family=binomial)
AIC(mod7) #4213.5 better
anova( mod6, mod7,  test="Chisq") #significant
vif(mod7)
residualPlot(mod7)
# Chunk 58
mod8 <- glm(Churn ~ tenure + MonthlyCharges + Contract + InternetService + StreamingMovies + StreamingTV + TechSupport, data=train, family=binomial)
#summary(mod8) #4208.3 better
AIC(mod8)
anova( mod7, mod8,  test="Chisq") #significant
vif(mod8)
residualPlot(mod8)
# Chunk 59
mod9 <- glm(Churn ~ tenure + MonthlyCharges + Contract + InternetService + StreamingMovies + StreamingTV + TechSupport + DeviceProtection, data=train, family=binomial)
summary(mod9) #4209.3 worse
AIC(mod9)
anova( mod8, mod9,  test="Chisq") #not significant
# Chunk 60
mod10 <- glm(Churn ~ tenure + MonthlyCharges + Contract + InternetService + StreamingMovies + StreamingTV + TechSupport + OnlineBackup, data=train, family=binomial)
AIC(mod10) #4209.6 worse
anova( mod8, mod10,  test="Chisq") #not significant
# Chunk 61
mod11 <- glm(Churn ~ tenure + MonthlyCharges + Contract + InternetService + StreamingMovies + StreamingTV + TechSupport + OnlineSecurity, data=train, family=binomial)
AIC(mod11) #4199 better
anova( mod8, mod11,  test="Chisq") #significant
vif(mod11)
residualPlot(mod11)
# Chunk 62
mod12 <- glm(Churn ~ tenure + MonthlyCharges + Contract + InternetService + StreamingMovies + StreamingTV + TechSupport + OnlineSecurity + PaperlessBilling, data=train, family=binomial)
summary(mod12) #4184.5 better
AIC(mod12)
anova( mod11, mod12,  test="Chisq") #significant
vif(mod12)
# Chunk 63
mod13 <- glm(Churn ~ tenure + MonthlyCharges + Contract + InternetService + StreamingMovies + StreamingTV + TechSupport + OnlineSecurity + PaperlessBilling + Dependents, data=train, family=binomial)
summary(mod13) #4177.2 better
AIC(mod13)
anova( mod12, mod13,  test="Chisq") #significant
vif(mod13)
# Chunk 64
mod14 <- glm(Churn ~ tenure + MonthlyCharges + Contract + InternetService + StreamingMovies + StreamingTV + TechSupport + OnlineSecurity + PaperlessBilling + Dependents + MultipleLines, data=train, family=binomial)
AIC(mod14) #4162.2 better
anova( mod13, mod14,  test="Chisq") #significant
vif(mod14)
# Chunk 65
mod15 <- glm(Churn ~ tenure + MonthlyCharges + Contract + InternetService + StreamingMovies + StreamingTV + TechSupport + OnlineSecurity + PaperlessBilling + Dependents + MultipleLines + SeniorCitizen, data=train, family=binomial)
AIC(mod15) #4155.7 better
anova( mod14, mod15,  test="Chisq") #significant
vif(mod15)
# Chunk 66
mod16 <- glm(Churn ~ tenure + MonthlyCharges + Contract + InternetService + StreamingMovies + StreamingTV + TechSupport + OnlineSecurity + PaperlessBilling + Dependents + MultipleLines + SeniorCitizen + Partner, data=train, family=binomial)
AIC(mod16) #4157.7 worse
anova( mod15, mod16,  test="Chisq") #not significant
# Chunk 67
mod17 <- glm(Churn ~ tenure + MonthlyCharges + Contract + InternetService + StreamingMovies + StreamingTV + TechSupport + OnlineSecurity + PaperlessBilling + Dependents + MultipleLines + SeniorCitizen + PaymentMethod, data=train, family=binomial)
AIC(mod17) #4139.4 better
anova( mod15, mod17,  test="Chisq") #significant
vif(mod17)
# Chunk 68
mod18 <- glm(Churn ~ tenure + MonthlyCharges + Contract + InternetService + StreamingMovies + StreamingTV + TechSupport + OnlineSecurity + PaperlessBilling + Dependents + MultipleLines + SeniorCitizen + PaymentMethod + PhoneService, data=train, family=binomial)
AIC(mod18)#4139.4 it does not change anything
anova( mod17, mod18,  test="Chisq") #not significant
# Chunk 69
infl_2 <- influence.measures(mod17)
sum(residuals(mod17,'deviance')^2)
sum(residuals(mod17,'pearson')^2)
influential_indices_2 <- which(infl_2$is.inf == TRUE)
length(influential_indices_2)
length(train$customerID)
# Chunk 70
mod19 <- glm(Churn ~ tenure + MonthlyCharges + Contract + InternetService + StreamingMovies + StreamingTV + TechSupport + OnlineSecurity + PaperlessBilling + Dependents * MultipleLines + SeniorCitizen + PaymentMethod, data=train, family=binomial)
#4140.4 worse
AIC(mod19)
anova( mod17, mod19,  test="Chisq") #not significant
# Chunk 71
mod20 <- glm(Churn ~ tenure + InternetService * MonthlyCharges + Contract + StreamingMovies + StreamingTV + TechSupport + OnlineSecurity + PaperlessBilling + Dependents + MultipleLines + SeniorCitizen + PaymentMethod, data=train, family=binomial)
AIC(mod20) #4133.7 better
anova( mod17, mod20,  test="Chisq") #significant
vif(mod20)
# Chunk 72
mod21 <- glm(Churn ~ tenure + InternetService + MonthlyCharges + Contract + StreamingMovies + StreamingTV + TechSupport + OnlineSecurity + PaperlessBilling + Dependents + MultipleLines + SeniorCitizen * PaymentMethod, data=train, family=binomial)
AIC(mod21) #4133 better and also better than mod20
anova( mod17, mod21,  test="Chisq") #significant
anova( mod20, mod21,  test="Chisq") #not significant
vif(mod21) #better multicollinearity
mod22 <- glm(Churn ~ tenure + InternetService * MonthlyCharges + Contract + StreamingMovies + StreamingTV + TechSupport + OnlineSecurity + PaperlessBilling + Dependents + MultipleLines + SeniorCitizen * PaymentMethod, data=train, family=binomial)
AIC(mod22) #4126.8 better
anova( mod21, mod22,  test="Chisq") #significant
anova( mod20, mod22,  test="Chisq") #significant
vif(mod22)
# Chunk 73
mod23 <- glm(Churn ~ tenure + I(tenure^2) + InternetService + MonthlyCharges + Contract + StreamingMovies + StreamingTV + TechSupport + OnlineSecurity + PaperlessBilling + Dependents + MultipleLines + SeniorCitizen * PaymentMethod, data=train, family=binomial)
AIC(mod23) #4088.4 better
anova( mod21, mod23,  test="Chisq") #significant
vif(mod23)
# Chunk 74
mod23.1 <- glm(Churn ~ tenure + I(tenure^2) + InternetService + Contract + StreamingMovies + StreamingTV + TechSupport + OnlineSecurity + PaperlessBilling + Dependents + MultipleLines + SeniorCitizen * PaymentMethod, data=train, family=binomial)
AIC(mod23.1) #4093.9 worse
anova( mod23, mod23.1,  test="Chisq") #significant
vif(mod23.1) #better vif
# Chunk 75
mod23.4 <- glm(Churn ~ log(tenure + 0.01) + I(tenure^2) + InternetService + Contract + StreamingMovies + StreamingTV + TechSupport + OnlineSecurity + PaperlessBilling + Dependents + MultipleLines + SeniorCitizen * PaymentMethod, data=train, family=binomial)
AIC(mod23.4) #4059.53
vif(mod23.4)
# Chunk 76
infl_3 <- influence.measures(mod23.4)
sum(residuals(mod23.4,'deviance')^2)
sum(residuals(mod23.4,'pearson')^2)
influential_indices_3 <- which(infl_3$is.inf == TRUE)
length(influential_indices_3)
length(train$customerID)
#Leverage values
plot(hatvalues(mod23.1), pch = 19, main = "Leverage Plot")
abline(h = 2 * ncol(model.matrix(mod23.1))/length(df$customerID), col = "red", lty = 2)
# Chunk 77
residualPlot(mod23.4)
rmse <- function(fitted, actual){
sqrt(mean((fitted - actual)^2))
}
RSQUARE <- function(predictions, actual_values) {
ss_residual <- sum((actual_values - predictions)^2)
ss_total <- sum((actual_values - mean(actual_values))^2)
rsquare <- 1 - (ss_residual / ss_total)
return(rsquare)
}
results <- data.frame(Model = c("Model with train_new sample",
"Model with test_new sample"),
RSQRT = round(c(RSQUARE((fitted(mod23.4)), train$churn),
RSQUARE((predict(mod23.4, newdata = test)), test$churn)),2),
RMSE = round(c(rmse((fitted(mod23.4)), train$churn),
rmse((predict(mod23.4, newdata = test)), test$churn)),2))
results
test_data <- test[c(3,5,6,8,9,10,13,14,15,16,17,18)]
results <- data.frame(Model = c("Model with train_new sample",
"Model with test_new sample"),
RSQRT = round(c(RSQUARE((fitted(mod23.4)), train$churn),
RSQUARE((predict(mod23.4, newdata = test_data)), test_data$churn)),2),
RMSE = round(c(rmse((fitted(mod23.4)), train$churn),
rmse((predict(mod23.4, newdata = test_data)), test_data$churn)),2))
roc_curve
roc_curve <- roc(test$Churn, pred_prob)
#selecting the parameters that we have in the model
test_data <- test[c(3,5,6,8,9,10,13,14,15,16,17,18)]
pred_prob <- predict(mod23.4, newdata = test_data, type="response")
churn_pred<- ifelse(pred_prob>0.5,"Yes","No")
table(churn_pred)
table(test$Churn)
#Confusion table
tt <- table(churn_pred, test$Churn);tt
100*sum(diag(tt))/sum(tt) #80.79
roc_curve <- roc(test$Churn, pred_prob)
roc_curve
# Plot the ROC curve
plot(roc_curve, main = "ROC Curve", col = "blue", lwd = 2)
# Add diagonal reference line for comparison
abline(a = 0, b = 1, lty = 2, col = "red")
# Add AUC (Area Under the Curve) value to the plot
text(0.8, 0.2, paste("AUC =", round(auc(roc_curve), 2)), col = "blue", cex = 1.2)
#selecting the parameters that we have in the model
test_data <- test[c(3,5,6,8,9,10,13,14,15,16,17,18)]
pred_prob <- predict(mod23.4, newdata = test_data, type="response")
churn_pred<- ifelse(pred_prob>0.5,"Yes","No")
table(churn_pred)
table(test$Churn)
#Confusion table
tt <- table(churn_pred, test$Churn);tt
100*sum(diag(tt))/sum(tt) #80.79
res.cat=catdes(df, 21)
res.cat$test.chi2
head(table(res.cat$category), n = 10)
head(res.cat$category)
lapply(res.cat$category, head, n = 5)
lapply(res.cat$category, tail, n = 5)
res.cat$category
res.cat$quanti.var
res.cat$quanti
