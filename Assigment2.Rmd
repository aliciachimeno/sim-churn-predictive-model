---
title: "Assigment 2"
author: "Alícia Chimeno Sarabia and Bruna"
date: "2023-12-02"
output:
  html_document: default
  pdf_document: default
editor_options: 
  chunk_output_type: console
---

# Libraries
```{r}
library(skimr)
library(car)
library(FactoMineR)
library(dplyr)

```

# Load dataset
```{r}
setwd("/Users/ali/Desktop/MASTER/SIM/proj2")
#setwd("C:/Users/Brunil/Desktop/Bruna/Master/SIM/assignment_2")
df<-read.csv("customer.xls", sep=",")
```

# Data context
This dataset contains information about customers. Demographic data, 

# Data exploration

```{r}
dim(df)
names(df)
str(df)
#summary(df)
#skim(df)
summary(is.na(df)) #we only have NA values in TotalCharges
```

## Variables description
In total, we have 21 variables related to demographic, services, and accountant data. One is the ID, three are numerical variables, and 17 are categorical (? binary) variables. We will conduct a descriptive analysis and a data quality report for each variable, considering aspects such as the number of missing values, errors, and the distribution or balance of the variable...
#### 1. customerID 

### Demographic data
#### 2. gender
Is a binary variable (female/male). 
```{r}
sum(is.na(df$gender))
barplot(table(df$gender), main = "Distribution of gender",xlab = "Gender",col = "skyblue") 
```

#### 3. SeniorCitizen
It is a binary variable. Levels: 1(=yes)/0(=no). 
```{r}
sum(is.na(df$SeniorCitizen))
table(df$SeniorCitizen)
barplot(table(df$SeniorCitizen), main = "Distribution of SeniorCitizen",xlab = "SeniorCitizen",col = "skyblue")
```

#### 4. Partner
It is a binary variable. Levels: Yes/No. 
```{r}
sum(is.na(df$Partner))
table(df$Partner)
barplot(table(df$Partner), main = "Distribution of Partner",xlab = "Partner",col = "skyblue")
```


#### 5. Dependents
It is a binary variable. Levels: Yes/No. 
```{r}
sum(is.na(df$Dependents))
table(df$Dependents)
barplot(table(df$Dependents), main = "Distribution of Dependents",xlab = "Dependents",col = "skyblue")

```

### Services of the costumer data
Services that each customer has signed up for :
#### 6. tenure
It is a numerical variable that indicates the duration, in months, that the customer has stayed with the company. 
```{r}
summary(df$tenure)
hist(df$tenure,breaks=20, col="skyblue")
min(df$tenure)
```

Let's look for the *outliers*. 
```{r}
boxplot(df$tenure, main="Outlier analysis for Tenure")

sm_t <- summary(df$tenure)
iqr_t <- sm_t["3rd Qu."] - sm_t["1st Qu."]
# Mild Outliers
mild_ub_t <- sm_t["3rd Qu."] + 1.5 * iqr_t
mild_lb_t <- sm_t["1st Qu."] - 1.5 * iqr_t
length(which(df$tenure > mild_ub_t | df$tenure < mild_lb_t)) # number of mild outliers

# Severe Outliers
severe_ub_t <- sm_t["3rd Qu."] + 3 * iqr_t
severe_lb_t <- sm_t["1st Qu."] - 3 * iqr_t
length(which(df$tenure > severe_ub_t | df$tenure < severe_lb_t)) # number of severe outliers
```
There are *no mild nor severe outliers* in Tenure. 

#### 7. PhoneService 
It is a binary variable. Levels: Yes/No. 
```{r}
sum(is.na(df$PhoneService))
table(df$PhoneService)
barplot(table(df$PhoneService), main = "Distribution of PhoneService",xlab = "PhoneService",col = "skyblue") #unbalanced
```

#### 8. MultipleLines
Categorical variable with 3 levels, No/No phone service/Yes. 
```{r}
sum(is.na(df$MultipleLines))
table(df$MultipleLines)
barplot(table(df$MultipleLines), main = "Distribution of MultipleLines",xlab = "MultipleLines",col = "skyblue") #unbalanced
```

Check inconsistencies: 
- Cannot happen that a costumer has not phoneservice and multiplelines.
```{r}
subset(df, MultipleLines == "Yes" & PhoneService == "No") 
```


#### 9. InternetService
Categorical variable with 3 levels: DSL/Fiber optic/No. 
```{r}
table(df$InternetService)
barplot(table(df$InternetService), main = "Distribution of InternetService",xlab = "InternetService",col = "skyblue") 
```

#### 10. OnlineSecurity
Categorical variable with 3 levels: No/No internet service/Yes 
```{r}
table(df$OnlineSecurity)
barplot(table(df$OnlineSecurity), main = "Distribution of OnlineSecurity",xlab = "OnlineSecurity",col = "skyblue") 
```

# Check concistency
```{r}
sum(df$InternetService == "No")
sum(df$OnlineSecurity == "No internet service")
nrow(subset(df, InternetService == "No" & OnlineSecurity == "No internet service"))
```


#### 11. OnlineBackup
Categorical variable with 3 levels: No/No internet service/Yes 
```{r}
table(df$OnlineBackup)
barplot(table(df$OnlineBackup), main = "Distribution of OnlineBackup",xlab = "OnlineBackup",col = "skyblue") 
```

```{r}
# Check concistency
sum(df$OnlineBackup == "No internet service") #1526
sum(df$OnlineSecurity == "No internet service") #1526
```

#### 12. DeviceProtection
Categorical variable with 3 levels: No/No internet service/Yes 
```{r}
table(df$DeviceProtection)
barplot(table(df$DeviceProtection), main = "Distribution of DeviceProtection",xlab = "DeviceProtection",col = "skyblue") 
```


```{r}
# Check concistency
sum(df$OnlineSecurity == "No internet service") #1526
sum(df$DeviceProtection == "No internet service") #1526
```

#### 13. TechSupport
Categorical variable with 3 levels: No/No internet service/Yes 
```{r}
table(df$TechSupport)
barplot(table(df$TechSupport), main = "Distribution of TechSupport",xlab = "TechSupport",col = "skyblue") 
```

```{r}
#Check consistency
sum(df$DeviceProtection == "No internet service") #1526
sum(df$TechSupport == "No internet service") #1526
```

#### 14. StreamingTV
Categorical variable with 3 levels: No/No internet service/Yes 
```{r}
table(df$StreamingTV)
barplot(table(df$StreamingTV), main = "Distribution of StreamingTV",xlab = "StreamingTV",col = "skyblue") 
```

```{r}
#Check consistency
sum(df$TechSupport == "No internet service") #1526
sum(df$StreamingTV == "No internet service") #1526
```
#### 15. StreamingMovies
Categorical variable with 3 levels: No/No internet service/Yes 
```{r}
table(df$StreamingMovies)
barplot(table(df$StreamingMovies), main = "Distribution of StreamingMovies",xlab = "StreamingMovies",col = "skyblue")
```

```{r}
#Check consistency
sum(df$StreamingTV == "No internet service") #1526
sum(df$StreamingMovies == "No internet service") #1526
```


### Customer account data
#### 16. Contract
Categorical variable with 3 levels: Month-to-month/One year/Two year 
```{r}
table(df$Contract)
barplot(table(df$Contract), main = "Distribution of Contract",xlab = "Contract",col = "skyblue")
```

#### 17. PaperlessBilling
It is a binary variable. Levels: No/Yes
```{r}
table(df$PaperlessBilling)
barplot(table(df$PaperlessBilling), main = "Distribution of PaperlessBilling",xlab = "PaperlessBilling",col = "skyblue")
```

#### 18. PaymentMethod
Categorical variable with 4 levels: Bank transfer (automatic)/Credit card (automatic)/Electronic check/Mailed check
```{r}
table(df$PaymentMethod)
barplot(table(df$PaymentMethod), main = "Distribution of PaymentMethod",xlab = "PaymentMethod",col = "skyblue")
```

Check inconsistencies: 

#### 19. MonthlyCharges 
It is a numerical variable.
```{r}
summary(df$MonthlyCharges)
hist(df$MonthlyCharges,breaks=20,col="skyblue")
```

Let's look for *outliers*. 
```{r}
Boxplot(df$MonthlyCharges, main="Outlier analysis for MonthlyCharges")
sm <- summary(df$MonthlyCharges)
iqr <- sm["3rd Qu."] - sm["1st Qu."]
# Mild Outliers
mild_ub <- sm["3rd Qu."] + 1.5 * iqr
mild_lb <- sm["1st Qu."] - 1.5 * iqr
length(which(df$MonthlyCharges > mild_ub | df$MonthlyCharges < mild_lb)) # number of mild outliers

# Severe Outliers
severe_ub <- sm["3rd Qu."] + 3 * iqr
severe_lb <- sm["1st Qu."] - 3 * iqr
length(which(df$MonthlyCharges > severe_ub | df$MonthlyCharges < severe_lb)) # number of severe outliers

```
There are no mild nor severe outliers in MonthlyCharges.

#### 20. TotalCharges (numeric)

It is a numerical variable.
```{r}
summary(df$TotalCharges)
sum(is.na(df$TotalCharges))
hist(df$TotalCharges,breaks=20,col="skyblue")
```

Let's look for *outliers*.
```{r}
Boxplot(df$TotalCharges, main="Outlier analysis for TotalCharges")
sm <- summary(df$TotalCharges)
iqr <- sm["3rd Qu."] - sm["1st Qu."]
# Mild Outliers
mild_ub <- sm["3rd Qu."] + 1.5 * iqr
mild_lb <- sm["1st Qu."] - 1.5 * iqr
length(which(df$TotalCharges > mild_ub | df$TotalCharges < mild_lb)) # number of mild outliers

# Severe Outliers
severe_ub <- sm["3rd Qu."] + 3 * iqr
severe_lb <- sm["1st Qu."] - 3 * iqr
length(which(df$TotalCharges > severe_ub | df$TotalCharges < severe_lb)) # number of severe outliers

```
There are no mild nor severe outliers.

### Target: 
#### 21. Churn
It is the target variable. It is binary, describes whether the customer churned or not (Yes or No). ?explicar que es churn una mica. 
```{r}
table(df$Churn)
prop.table(table(df$Churn))
barplot(table(df$Churn), col="skyblue")
```


## Data preprocessing
### Recode variables into correct type
We shall reconvert the type of certain variables that are encoded with wrong type. First, we convert the character variables (except the ID) into factors.
```{r}
char_cols <- which(sapply(df, is.character))
df[, char_cols[-1]]<- lapply(df[, char_cols[-1]], as.factor) 
```

Also, we convert the numerical variable SeniorCitizen into a factor.  
```{r}
df$SeniorCitizen<- factor(df$SeniorCitizen)
```

```{r}
summary(df)
str(df)
```

### Data imputation
```{r}
summary(is.na(df))
```
Only the variable TotalCharges has NA's. 

```{r}
df[is.na(df$TotalCharges), ]
df[df$tenure==0,]
df[df$TotalCharges==0, ]
summary(df$TotalCharges)
```
The missing data corresponds to the individuals that have not payed yet the charges of the current month, we can guess that are new clients of the company.

Duplicate values: no
```{r}
dim(df)
length(unique(df$customerID))
```


El significat d'aquestos NA son que l'individuu encara no se li ha cobrat el charges ja que no ha arribat a final de més. Una possible solució seria que la variable totalcharges prengui el valor de monthlycharges. 

Suggerim quan tenure==0 eliminem les observacions enlloc d'imputar-les ja que representen un 0.1% de les dades.  NO ELIMINEM FIQUEM 0
```{r}
ll <- which(is.na(df$TotalCharges))
df[ll,"TotalCharges"] <- 0
summary(is.na(df$TotalCharges))
```

Això crec que és un pas que està descrit al pdf però no sé perquè s'ha de fer

Create variable adding the total number missing values, outliers and errors. Describe these variables, to which other variables exist higher associations.  Compute the correlation with all other variables. Rank these variables according the correlation  Compute for every group of individuals (group of age, size of town, singles, married, …) the mean of missing/outliers/errors values. Rank the groups according the computed mean. 

### Correlation btween numericals
(no cal)
```{r}
num_cols <- which(sapply(df, is.numeric))
cor(df[,c(6,19,20)])
```

### Correlation between categorical
```{r}

categorical_var_names <- names(df)[categorical_vars]

# Create an empty matrix to store Cramér's V values
cramer_matrix <- matrix(NA, nrow = length(categorical_var_names), ncol = length(categorical_var_names), dimnames = list(categorical_var_names, categorical_var_names))

for (i in seq_along(categorical_var_names)) {
  for (j in seq_along(categorical_var_names)) {
    # Create contingency table
    contingency_table <- table(df[[categorical_var_names[i]]], df[[categorical_var_names[j]]])
    
    # Calculate Cramér's V
    chi_square_stat <- chisq.test(contingency_table)$statistic
    n <- sum(contingency_table)
    k <- min(dim(contingency_table))
    cramers_v <- sqrt(chi_square_stat / (n * (k - 1)))
    
    # Store Cramér's V in the matrix
    cramer_matrix[i, j] <- cramers_v
  }
}

print(cramer_matrix)

threshold <- 0.8

# Find the indices of elements greater than the threshold
indices <- which(cramer_matrix > threshold, arr.ind = TRUE)

# Extract variable pairs and their corresponding Cramér's V values
selected_pairs <- data.frame(
  Variable1 = rownames(cramer_matrix)[indices[, 1]],
  Variable2 = colnames(cramer_matrix)[indices[, 2]],
  Cramers_V = cramer_matrix[indices]
)

# Display selected pairs
print(selected_pairs)
```

The categorical variables MultipleLines and PhoneService are 100% correlated. 
```{r}
contingency_table<-table(df$MultipleLines,df$PhoneService)
sqrt(chisq.test(contingency_table)$statistic / (sum(contingency_table) * (min(dim(contingency_table)) - 1)))
```

### variables with near zero variance ?  

### Profiling 

```{r}
res.cat=catdes(df, 21)
res.cat$test.chi2
res.cat$category
res.cat$quanti.var
res.cat$quanti
```

Regarding to the results of the test $Chi^2$ all correlations with the variables
are significant since the $p-value$ is less than 0,05.
Since the response variable is binary, we have different results for each answer and also for all outcomes of the categorical parameters.

For example, we can analyse in detail the variable "Contract". For the customers that haven't churned, the correlation between the ones that have a contract of two year is directly proportional and it's the highest relation. However, we can see that is the costumer has churned the ones that have a two-year contract have an strong negative correlation. The ones that have a month-to-month contract are the opposite of the previous answer; they have the highest positive correlation with the costumers that have churned and the negative with the ones that haven't.

Besides the latter variable, we can observe the parameter that have a higher positive correlation with the costumers that churn is the parameter "OnlineSecurity" and "TechSupport" when the answer is "No". The parameters that have a negative relation with the costumers that churn are when they haven't hired an Internet Service. We can see that all parameters that have an answer that is "No internet service" have also a negative relation with the response variable "Yes". We can deduce that they might have multicollinearity with the parameter Internet Service, but we will check it later.

The parameters that have a higher positive relation with the costumers that don't churn are the ones that have a negative relation when the response variable is "Yes", that we have analysed before. In the same vein, we can observe that the parameters that have a negative relation with the costumers that churn are "OnlineSecurity" and "TechSupport" when the answer is "No", the same parameters that have a positive relation when the costumers churn. We can see that the target answer "Yes" and "No" have an approximate opposite correlations with the explanatory variables.






###Modelling

Modelling:
Train - test → dubte: abans o després de balancejar les dades?
The dataset is imbalanced.
Use only glm() modeling tools (parametric and traditional statistical models, baseline for comparison to ML approaches being developed in other subjects)
Assessment metric: area under the ROC curve score and confusion table prediction capability analysis (recall, F1-score, etc) for train sample and confusion table for test sample


```{r}
set.seed(1234)
m <- floor(0.7*nrow(df))
train_d <- sample(seq_len(nrow(df)),size = m)

train <- df[train_d,]
test <- df[-train_d,]

names(df)
```
##############################################################
Target variable is Churn. 

We start the modeling by the null model.
```{r}
mod0 <- glm(Churn ~ 1, data=train, family=binomial)
mod0$deviance
```

We continiue by adding the numerical variables and assessing the model.
```{r}
which(sapply(df, is.numeric))
```

We start by tenure
```{r}
mod1 <- glm(Churn ~ tenure, data=train, family=binomial)
mod1$deviance;AIC(mod0,mod1) #summary(mod1)
anova( mod0, mod1,  test="Chisq")
```

we use a second order variable
```{r}
mod1q <- glm(Churn ~ tenure + I(tenure^2), data=train, family=binomial)
summary(mod1q)
anova( mod1, mod1q,  test="Chisq")
#residualPlots(mod1q); marginalModelPlots(mod1q)

```


Add MonthlyCharges 
```{r}
mod2 <- glm(Churn ~ tenure + I(tenure^2)+ MonthlyCharges, data=train, family=binomial)
mod2$deviance
anova( mod1, mod2,  test="Chisq")
```

consider interactions
```{r}
mod2i <- glm(Churn ~ (tenure + I(tenure^2) ) *MonthlyCharges, data=train, family=binomial)
mod2i$deviance
anova( mod2, mod2i,  test="Chisq")
summary(mod2i)
```

Add TotalCharges

```{r}
mod3 <- glm(Churn ~ (tenure + I(tenure^2) ) *MonthlyCharges + TotalCharges, data=train, family=binomial)
mod3$deviance  
anova( mod2i, mod3,  test="Chisq")
summary(mod3)
```
It is not significant enough. We don't add it in our model. 

Now, we shall add the categorical variables. The order of addition is significant, therefore we start by adding the most correlated variables with the target. 
We start with *Contract* variable. 
```{r}
mod4 <- glm(Churn ~ (tenure + I(tenure^2) ) *MonthlyCharges + Contract, data=train, family=binomial)
summary(mod4)
anova( mod2i, mod4,  test="Chisq")
```

```{r}
mod5 <- glm(Churn ~ (tenure + I(tenure^2) ) *MonthlyCharges + Contract+StreamingMovies, data=train, family=binomial)
summary(mod5)
anova( mod4, mod5,  test="Chisq")
```



Això ho podem posar a l'annex i deixem els comentaris al report

Univariate

```{r}
names(train)

mod <- glm(Churn ~ gender, data=train, family=binomial)
summary(mod)

mod2 <- glm(Churn ~ SeniorCitizen, data=train, family=binomial)
summary(mod2)

mod3 <- glm(Churn ~ Partner, data=train, family=binomial)
summary(mod3)

mod4 <- glm(Churn ~ Dependents, data=train, family=binomial)
summary(mod4)

mod5 <- glm(Churn ~ tenure, data=train, family=binomial)
summary(mod5)

mod6 <- glm(Churn ~ PhoneService, data=train, family=binomial)
summary(mod6)

mod7 <- glm(Churn ~ MultipleLines, data=train, family=binomial)
summary(mod7)

mod8 <- glm(Churn ~ InternetService, data=train, family=binomial)
summary(mod8)

mod9 <- glm(Churn ~ OnlineSecurity, data=train, family=binomial)
summary(mod9)

mod10 <- glm(Churn ~ OnlineBackup, data=train, family=binomial)
summary(mod10)

mod11 <- glm(Churn ~ DeviceProtection, data=train, family=binomial)
summary(mod11)

mod12 <- glm(Churn ~ TechSupport, data=train, family=binomial)
summary(mod12)

mod13 <- glm(Churn ~ StreamingTV, data=train, family=binomial)
summary(mod13)

mod14 <- glm(Churn ~ StreamingMovies, data=train, family=binomial)
summary(mod14)

mod15 <- glm(Churn ~ Contract, data=train, family=binomial)
summary(mod15)

mod16 <- glm(Churn ~ PaperlessBilling, data=train, family=binomial)
summary(mod16)

mod17 <- glm(Churn ~ PaymentMethod, data=train, family=binomial)
summary(mod17)

mod18 <- glm(Churn ~ MonthlyCharges, data=train, family=binomial)
summary(mod18)

mod19 <- glm(Churn ~ TotalCharges, data=train, family=binomial)
summary(mod19)
```

```{r}

md <- glm(Churn ~ gender+SeniorCitizen+Partner+Dependents+tenure+PhoneService+MultipleLines+InternetService+OnlineSecurity+OnlineBackup+DeviceProtection+TechSupport+StreamingTV+StreamingMovies+Contract+PaperlessBilling+PaymentMethod+MonthlyCharges+TotalCharges, data=train, family=binomial)
summary(md)

str(train)
summary(train)
#md <- glm(Churn ~ ., data = df, family = binomial)
#summary(md)
```

Variables that contain "No internet service as a response":

MultipleLines
OnlineSecurity
OnlineBackup
DeviceProtection
TechSupport
StreamingTV
StreamingMovies

##Model with InternetService = Yes (DSL;Fiber Optic)

Out of the model InternetService 

```{r}
train_IS <- train[train$InternetService!="No",]

attach(train_IS)

summary(train_IS)

md_2 <- glm(Churn ~ gender+SeniorCitizen+Partner+Dependents+tenure+PhoneService+MultipleLines+OnlineSecurity+OnlineBackup+DeviceProtection+TechSupport+StreamingTV+StreamingMovies+Contract+PaperlessBilling+PaymentMethod+MonthlyCharges+TotalCharges, data=train_IS, family=binomial)
summary(md_2)

```



Out of the model: No internet service as a response for 

```{r}
md2 <- glm(Churn ~ gender+SeniorCitizen+Partner+Dependents+tenure+PhoneService+MultipleLines+OnlineSecurity+OnlineBackup+DeviceProtection+TechSupport+StreamingTV+StreamingMovies+Contract+PaperlessBilling+PaymentMethod+MonthlyCharges+TotalCharges, data=train, family=binomial)

summary(md2)
```

CREC QUE ES LA MILLOR SOLUCIO

Transforming "No Internet Service" into "No" since if we keep the parameter "InternetService" we already have the information and "No phone service" to "No" since the information is contained in "PhoneService".

MultipleLines
OnlineSecurity
OnlineBackup
DeviceProtection
TechSupport
StreamingTV
StreamingMovies

```{r}

train$OnlineSecurity[train$OnlineSecurity=="No internet service"] <- "No"
train$OnlineBackup[train$OnlineBackup=="No internet service"] <- "No"
train$DeviceProtection[train$DeviceProtection=="No internet service"] <- "No"
train$TechSupport[train$TechSupport=="No internet service"] <- "No"
train$StreamingTV[train$StreamingTV=="No internet service"] <- "No"
train$StreamingMovies[train$StreamingMovies=="No internet service"] <- "No"

train$MultipleLines[train$MultipleLines=="No phone service"] <- "No"
summary(train)
```


##Model after transformations

```{r}
md <- glm(Churn ~ gender+SeniorCitizen+Partner+Dependents+tenure+PhoneService+MultipleLines+InternetService+OnlineSecurity+OnlineBackup+DeviceProtection+TechSupport+StreamingTV+StreamingMovies+Contract+PaperlessBilling+PaymentMethod+MonthlyCharges+TotalCharges, data=train, family=binomial)
summary(md)
```

We keep the parameters that are significant for the model:

SeniorCitizen
tenure
MultipleLines
InternetService
Contract
PaymentMethod
TotalCharges

StreamingTV and StreamingMovies are almost significant. We may try to add it with some transformation or with less noise caused by the other parameters.

```{r}
md_2 <- glm(Churn ~ SeniorCitizen+tenure+MultipleLines+InternetService+StreamingTV+StreamingMovies+Contract+PaymentMethod+TotalCharges, data=train, family=binomial)
summary(md_2)

md_3 <- glm(Churn ~ SeniorCitizen+tenure+MultipleLines+InternetService+StreamingTV+Contract+PaymentMethod+TotalCharges, data=train, family=binomial)
summary(md_3)

anova(md_2, md_3, test="Chisq")
```

StreamingTV is significant now, but StreamingMovies no, we can descart this last one. We have applied an anova test for confirming that we don't need StreamingMovies. 

```{r}
md_aic <- step(md)

md_3_aix <- step(md_3)

```
- PhoneService      1   4083.0 4121.0
- Dependents        1   4083.0 4121.0
- OnlineBackup      1   4083.1 4121.1
- DeviceProtection  1   4084.7 4122.7
- SeniorCitizen     1   4085.4 4123.4
- PaperlessBilling  1   4090.7 4128.7
- PaymentMethod     3   4102.1 4136.1
- TotalCharges      1   4099.8 4137.8
- StreamingMovies   1   4099.9 4137.9
- MonthlyCharges    1   4102.1 4140.1
- StreamingTV       1   4104.9 4142.9
- MultipleLines     1   4105.2 4143.2
- InternetService   2   4129.3 4165.3
- Contract          2   4145.0 4181.0
- tenure            1   

```{r}
md_step <- glm(Churn ~ PhoneService + Dependents + OnlineBackup + DeviceProtection + SeniorCitizen + PaperlessBilling + PaymentMethod + TotalCharges + StreamingMovies + MonthlyCharges + StreamingTV + MultipleLines + InternetService + Contract + tenure, data = train, family=binomial)

summary(md_step)
```

